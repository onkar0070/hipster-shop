apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: hipster-shop-monitor
  namespace: monitoring     # ðŸ‘ˆ should be in the monitoring namespace, where Prometheus runs
  labels:
    release: monitoring      # ðŸ‘ˆ must match your Prometheus release label (yours was "monitoring", not "hipster-shop")
spec:
  selector:
    matchExpressions:
      - key: app
        operator: In
        values:
          - adservice
          - cartservice
          - checkoutservice
          - currencyservice
          - emailservice
          - frontend
          - paymentservice
          - productcatalogservice
          - recommendationservice
          - shippingservice
  namespaceSelector:
    matchNames:
      - hipster-shop          # ðŸ‘ˆ your services live in hipster-shop, not default
  endpoints:
    - port: metrics           # ðŸ‘ˆ should match the sidecar container port name (we defined `name: metrics`)
      interval: 15s
      path: /metrics
      scheme: http

